# 简介

Linux DRM（Direct Rendering Manager，直接渲染管理器）层包含旨在支持复杂图形设备需求的代码，这些设备通常包含非常适合 3D 图形加速的可编程流水线。内核中的图形驱动程序可以利用 DRM 函数来简化内存管理、中断处理和 DMA 等任务，并为应用程序提供统一的接口。

关于版本的说明：本指南涵盖了 DRM 代码树中的功能，包括 TTM 内存管理器、输出配置和模式设置，以及新的 vblank 内部实现，此外还有当前内核中的所有常规功能。

[此处插入典型 DRM 堆栈示意图]

## 风格指南

为了保持一致性，本文档使用美式英语。缩写全部使用大写字母书写，例如：DRM、KMS、IOCTL、CRTC 等。为了便于阅读，文档充分利用了 kerneldoc 提供的标记字符：`@parameter` 用于函数参数，`@member` 用于结构体成员（在同一结构体内），`&struct structure` 用于引用结构体，`function()` 用于函数。如果被引用对象存在 kerneldoc 文档，这些都会自动生成超链接。当引用函数虚函数表（以及一般的结构体成员）中的条目时，请使用 `&vtable_name.vfunc`。遗憾的是，这目前还不能直接链接到成员，只能链接到结构体。

除非在特殊情况下（用于区分加锁和未加锁的变体），函数的锁定要求不会在 kerneldoc 中记录。相反，应该在运行时使用例如 `WARN_ON(!mutex_is_locked(...));` 来检查锁定状态。由于忽略文档比忽略运行时警告要容易得多，这种方式提供了更多价值。此外，当锁定规则发生变化时，运行时检查也需要更新，这增加了它们正确的可能性。在文档中，锁定规则应该在相关结构体中解释：要么在锁的注释中说明它保护什么，要么在数据字段中注明哪个锁保护它们，或者两者兼有。

具有非 `void` 返回值的函数应该有一个名为 "Returns"（返回值）的章节，解释不同情况下的预期返回值及其含义。目前对于该章节名称是否应该全部大写，以及是否应该以冒号结尾，尚无共识。请遵循文件本地的风格。其他常见的章节名称包括 "Notes"（注意事项）用于危险或棘手的边界情况，以及 "FIXME" 用于可以清理接口的地方。

另请阅读[内核文档的通用指南](../doc-guide/)。

## 入门指南

欢迎有兴趣帮助开发 DRM 子系统的开发者。人们通常会针对 checkpatch 或 sparse 报告的各种问题提交补丁。我们欢迎这样的贡献。

任何想要更进一步的人都可以在 [TODO 列表](todo.rst) 中找到维护任务清单。

## 贡献流程

DRM 子系统的工作方式大体上与其他内核子系统相同，请参阅[主要流程指南和文档](../process/)了解工作方式。这里我们只记录 GPU 子系统的一些特殊之处。

### 功能合并截止日期

所有功能工作必须在当前发布周期的 -rc6 版本之前进入 linux-next 代码树，否则必须推迟，无法赶上下一个合并窗口。所有补丁最迟必须在 -rc7 之前进入 drm-next 代码树，但如果您的分支不在 linux-next 中，则必须在 -rc6 之前完成。

在此之后，只允许提交错误修复（就像上游合并窗口在 -rc1 版本发布后关闭一样）。不允许新的平台支持或新驱动程序。

这意味着大约有一个月的封锁期，在此期间功能工作无法合并。推荐的处理方式是维护一个始终开放的 -next 代码树，但确保在封锁期内不将其提交到 linux-next。例如，drm-misc 就是这样运作的。

### 行为准则

作为 freedesktop.org 项目，dri-devel 和 DRM 社区遵循贡献者公约，详见：https://www.freedesktop.org/wiki/CodeOfConduct

在邮件列表、IRC 或问题跟踪器上与社区成员互动时，请以尊重和文明的方式行事。社区代表整个项目，项目不容忍辱骂或欺凌行为。
